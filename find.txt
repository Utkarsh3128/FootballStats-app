

import { createContext, useContext, useReducer, useEffect } from "react";
import reducer from "./Reducer";
import playerContext from "../Context/playerContext";

const {year} = useContext(playerContext);

const api = `https://api-football-beta.p.rapidapi.com/players/topscorers?season=2023&league=307`;
const options = {
  method: "GET",
  headers: {
    "X-RapidAPI-Key": "b7f2ee5985mshd8888e7fba34037p1ae3aajsnc80a1461299d",
    "X-RapidAPI-Host": "api-football-beta.p.rapidapi.com",
  },
};

const initialState = {
  response: [],
};

const AppContext = createContext();

const AppProvider = ({ children }) => {
  const [state, dispatch] = useReducer(reducer, initialState);

  const fetchData = async (url) => {
    try {
      const res = await fetch(url, options);
      const data = await res.json();
      console.log(data);
      dispatch({
        type: "GET_STAT",
        payload: {
          response: data.response,
        },
      });
    } catch (error) {
      console.log(error);
    }
  };

  useEffect(() => {
    fetchData(api);
  }, []);

  return (
    <>
      <AppContext.Provider value={{ ...state }}>{children}</AppContext.Provider>
    </>
  );
};

// custom hook
const useGlobalContext = () => {
  return useContext(AppContext);
};

export { AppContext, AppProvider, useGlobalContext };
